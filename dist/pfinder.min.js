(()=>{function v(h,e,l){return{x:h,y:e,parent:null,children:[],isWall:l,inOpen:!1,inClose:!1,g:0,f:0}}function k(h,e){let l=h.length,r=h[0].length,t=[];for(let i=0;i<l;i++){let f=new Array(r).fill(0);f.forEach((o,a)=>{f[a]=v(a,i,h[i][a])}),t.push(f)}for(let i=0;i<l;i++){let f=t[i];f.forEach((o,a)=>{let n=[],u=!1,p=!1,c=!1,g=!1,w=!1,C=!1,P=!1,M=!1;if(a>0){let s=f[a-1];c=!0,s.isWall&&(P=!0),s.isWall||n.push(s)}if(a<r-1){let s=f[a+1];g=!0,s.isWall&&(M=!0),s.isWall||n.push(s)}if(i>0){let s=t[i-1][a];u=!0,s.isWall&&(w=!0),s.isWall||n.push(s)}if(i<l-1){let s=t[i+1][a];p=!0,s.isWall&&(C=!0),s.isWall||n.push(s)}if(e){if(u&&c){let s=t[i-1][a-1];s.isWall||n.push(s)}if(u&&g){let s=t[i-1][a+1];s.isWall||n.push(s)}if(p&&c){let s=t[i+1][a-1];s.isWall||n.push(s)}if(p&&g){let s=t[i+1][a+1];s.isWall||n.push(s)}}else{if(u&&c&&!(w||P)){let s=t[i-1][a-1];s.isWall||n.push(s)}if(u&&g&&!(w||M)){let s=t[i-1][a+1];s.isWall||n.push(s)}if(p&&c&&!(C||P)){let s=t[i+1][a-1];s.isWall||n.push(s)}if(p&&g&&!(C||M)){let s=t[i+1][a+1];s.isWall||n.push(s)}}t[i][a].children=n})}return t}var m=class{constructor(e){this.items=[],this.prop=e}push(e){if(!this.items.length){e.inOpen=!0,this.items.push(e);return}for(let l=this.items.length-1;l>=0;l--)if(this.items[l][this.prop]>=e[this.prop]){this.items.splice(l+1,0,e);return}this.items.unshift(e)}},d=class{constructor(e,l,r){let t=[];for(let i=0;i<r;i++)t.push(new m(e));this.heaps=t,this.prop=e,this.range=l,this.count=0}addHeaps(e){for(let l=0;l<e;l++)this.heaps.push(new m(this.prop))}push(e){this.count++;let l=e[this.prop]/this.range|0;l>this.heaps.length-1&&this.addHeaps(l-(this.heaps.length-1)),this.heaps[l].push(e)}pop(){if(this.count--,this.count<0)return this.count=0,null;for(let e=0;e<this.heaps.length;e++)if(this.heaps[e].items.length)return this.heaps[e].items.pop()}};var E=0;function F(h,e,l){let r=[],t=h,i=0;for(;t&&(r[i++]={x:t.x,y:t.y},!(t.x==e&&t.y==l));)t=t.parent;return r.reverse()}function G(h,e,l){let r=Math.abs(h.x-e),t=Math.abs(h.y-l);return Math.floor(10*(r+t)-5.857*Math.min(r,t))}function O(h,e,l,r,t){if(h[l][e].isWall||h[t][r].isWall)return null;let i=E++;h[l][e].signature=i,h[l][e].inOpen=!1,h[l][e].inClose=!1;let f=new d("f",100,10);for(f.push(h[l][e]);f.count;){let o=f.pop();if(o.inOpen=!1,o.inClose=!0,o.x==r&&o.y==t)return F(o,e,l);o.children.forEach(n=>{if(n.signature!=i&&(n.signature=i,n.inClose=!1,n.inOpen=!1,n.f=0,n.g=0),n.inClose)return;let u=o.g+1;n.g<u&&(n.parent=o,n.g=u,n.f=u+G(n,r,t),n.inOpen||f.push(n))})}return null}var W=new Map,b=1e3;function H(h,e,l,r,t){W.size>b&&W.delete(W.keys().next().value);let i=e+"."+l+"."+r+"."+t;W.set(i,h)}function z(h,e,l,r,t){if(h[l][e].isWall||h[t][r].isWall)return null;let i=W.get(e+"."+l+"."+r+"."+t);return i!==void 0||(i=getPath(h,e,l,r,t),H(i,e,l,r,t)),i}function S(h){b=h}typeof window<"u"&&(globalThis.Pfinder={getPath:O,getPathFromCache:z,makeGrid:k,setMaxCacheSize:S});})();
/**
* @copyright    2023 Juan Jose Capellan
* @license      {@link https://github.com/jjcapellan/pfinder/blob/master/LICENSE | MIT License}
*/
